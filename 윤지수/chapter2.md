# [2장] 타입스크립트: 3,000미터 상공에서 내려다보기

## 컴파일러

>프로그램 실행?
>
>- 컴파일러
>
>**텍스트 파일 > 추상문법트리(AST) > 바이트코드** 변환
>
>
>- 런타임
>
>바이트코드 평가, 결과 획득

<br/>

- 타입스크립트는 컴파일러가 코드를 바이트코드X **자바스크립트 코드**O로 변환

- AST를 만들어 결과 코드를 내놓기 전에 타입 확인


>**타입 검사기(typechecker)**
>
>코드의 타입 안전성을 검증하는 특별한 프로그램

- 타입 확인 => 프로그램이 개발자의 기대대로 실행 가능, 명백한 실수가 들어가지 않게 방지

<br/>

>**타입스크립트 컴파일 및 실행**  
>- --------------- TSC 수행 ---------------
>1. 타입스크립트 소스 > 타입스크립트 AST
>2. 타입 검사기가 AST 확인
>3. 타입스크립트 AST > 자바스크립트 소스  
>- -------- 자바스크립트 런타임 수행 --------
>4. 자바스크립트 소스 > 자바스크립트 AST  
>5. AST > 바이트코드  
>6. 런타임이 바이트코드 평가

과정 1~2: 소스 코드에 사용된 타입 이용, 과정 3: 이용 X  
=> TSC가 타입스크립트 코드를 자바스크립트 코드로 컴파일할 때는 개발자가 사용한 타입 확인 X  
=> 개발자가 코드에 기입한 타입 정보  
: 최종적으로 만들어지는 프로그램에 아무런 영향을 주지 않음  
: 단지 타입 확인에 사용됨

<br/>

## 타입 시스템

>**타입 시스템(type system)**
>
>타입 검사기가 프로그램에 타입을 할당하는 데 사용하는 규칙 집합  
>1. 어떤 타입을 사용하는지를 컴파일러에 명시적으로 알려주는 타입시스템
>2. 자동으로 타입을 추론하는 타입 시스템

- 타입스크립트는 두 가지 시스템 모두의 영향을 받음  
=> 개발자는 타입을 명시하거나 타입스크립트가 추론하도록 하는 방식 중에서 선택 가능

1. **어노테이션**
- 타입스크립트에 명시적으로 타입 지정
- `value: type`: 타입 검사기에 '이 value의 타입은 type이야' 알리는 역할
```typescript
let a: number = 1
let b: string = 'hello'
let c: boolean[] = [true, false]
```

2. 어노테이션을 사용하지 않으면 **타입스크립트가 알아서 타입 추론**
```typescript
let a = 1
let b = 'hello'
let c = [true, false]
```

> 💡 타입스크립트가 타입을 추론하도록 두는 것이 코드를 줄일 수 있는 방법 => 보통 어노테이션 생략

<br/>

- **점진적으로 타입을 확인하는 언어**

  - 프로그램을 컴파일하는데 반드시 모든 타입을 알아야하는 것은 아님
  - 타입을 지정하지 않은 프로그램이라도 그중 일부 타입을 추론해서 오류를 검출할 수 있지만, 모든 타입을 알지 못하는 상황에서는 많은 오류가 사용자에게 그대로 노출될 수 있음
  - 기존 자바스크립트 코드를 타입스크립트로 마이그레이션할 때 특히 유용
  - 모든 코드의 타입을 컴파일 타임에 지정하는 것을 목표로 해야 함

<br/>

- **타입 변환 명시적으로**

  - 올바르지 않아 보이는 연산을 수행하면 타입스크립트가 바로 그 부분을 지적
  - 의도를 명시해야 타입스크립트의 지적을 무사히 통과
```typescript
3 + [1];	// '+' 연산자를 '3'과 'number[]' 타입에 적용할 수 없음
(3).toString() + [1].toString()	// "31"로 평가
```

<br/>

- **컴파일 타임에 코드 타입 확인**

  - 정적으로 코드 분석하여 에러 검출
  - 코드를 실행하지 않고도 에러가 있음을 바로 알 수 있음
  - 코드가 컴파일되지 않는다는 사실은 개발자가 실수를 저질렀음을 뜻하므로 코드를 실행하기 전에 실수를 바로 잡을 수 있는 좋은 기회

<br/>

- **컴파일 타임에 문법 에러와 타입 관련 에러 모두 검출**

  - 코드 편집기가 에러를 바로 보여줌
  - 스택 오버플로, 네트워크 연결 끊김, 잘못된 사용자 입력 등 컴파일 타임에 검출할 수 없는 런타임 예외도 많음

<br/>

>**자바스크립트와 타입스크립트의 타입 시스템 비교**
>
|타입 시스템 기능|자바스크립트|타입스크립트|
|---|:---:|:---:|
|타입 결정 방식|동적|정적|
|타입이 자동으로 변환되는가?|O|X(대부분)|
|언제 타입을 확인하는가?|런타임|컴파일 타임|
|언제 에러를 검출하는가?|런타임(대부분)|컴파일 타임(대부분)|
